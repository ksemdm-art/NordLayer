<template>
  <div class="min-h-screen bg-gradient-frost flex items-center justify-center px-4">
    <div class="max-w-md w-full bg-white rounded-2xl shadow-aurora p-8 text-center">
      <!-- Success Icon -->
      <div class="w-20 h-20 bg-accent-100 rounded-full flex items-center justify-center mx-auto mb-6">
        <svg class="w-10 h-10 text-accent-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      </div>

      <!-- Success Message -->
      <h1 class="text-2xl font-bold text-primary-900 mb-4">
        –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç –≤ —Ä–∞–±–æ—Ç—É!
      </h1>
      
      <div class="space-y-4 text-primary-700 mb-8">
        <p class="text-lg">
          <span v-if="orderId && orderId !== 'N/A'">
            –í–∞—à –∑–∞–∫–∞–∑ <span class="font-semibold text-accent-600">#{{ orderId }}</span> —É–∂–µ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π
          </span>
          <span v-else>
            –í–∞—à –∑–∞–∫–∞–∑ —É–∂–µ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π
          </span>
        </p>
        
        <p>
          –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π
        </p>
        
        <div class="bg-primary-50 border border-primary-200 rounded-lg p-4 text-sm">
          <p class="font-medium text-primary-900 mb-2">–ö–∞–∫ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º:</p>
          <ul class="text-left space-y-1 text-primary-700">
            <li>‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è</li>
            <li>‚Ä¢ –û–±—Å—É–∂–¥–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π</li>
            <li>‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–π –∑–∞ —Å–ª–æ–µ–º —Å –¥—É—à–æ–π</li>
            <li>‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</li>
          </ul>
        </div>
      </div>

      <!-- Actions -->
      <div class="space-y-3">
        <button
          @click="goHome"
          class="w-full bg-primary-900 text-white py-3 px-6 rounded-lg font-medium hover:bg-primary-800 hover:shadow-glow-nordic transition-all duration-300"
        >
          –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
        </button>
        
        <button
          @click="showReviewForm"
          class="w-full bg-accent-500 text-white py-3 px-6 rounded-lg font-medium hover:bg-accent-600 hover:shadow-glow-copper transition-all duration-300"
        >
          –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
        </button>
        
        <button
          @click="createNewOrder"
          class="w-full bg-primary-100 text-primary-700 py-3 px-6 rounded-lg font-medium hover:bg-primary-200 transition-colors"
        >
          –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
        </button>
      </div>

      <!-- Contact Info -->
      <div class="mt-8 pt-6 border-t border-primary-200 text-sm text-primary-500">
        <p>–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏:</p>
        <div class="flex justify-center space-x-4 mt-2">
          <a href="tel:+79214558534" class="text-accent-600 hover:text-accent-800">üìû +7 (921) 455-85-34</a>
          <a href="mailto:nordlayer@yandex.com" class="text-accent-600 hover:text-accent-800">‚úâÔ∏è nordlayer@yandex.com</a>
        </div>
      </div>
    </div>

    <!-- Review Modal -->
    <div v-if="showReviewModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
      <div class="bg-white rounded-2xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-primary-900">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h2>
            <button
              @click="closeReviewModal"
              class="text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>

          <ReviewForm
            :order-id="parseInt(orderId)"
            :customer-name="''"
            :customer-email="''"
            @submit="handleReviewSubmit"
            @cancel="closeReviewModal"
          />
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { onMounted, ref } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import ReviewForm from '@/components/reviews/ReviewForm.vue'

const route = useRoute()
const router = useRouter()

const orderId = ref(route.params.id as string || 'N/A')
const showReviewModal = ref(false)

const goHome = () => {
  router.push('/')
}

const createNewOrder = () => {
  router.push('/order')
}

const showReviewForm = () => {
  showReviewModal.value = true
}

const closeReviewModal = () => {
  showReviewModal.value = false
}

const handleReviewSubmit = (reviewData: any) => {
  console.log('Review submitted:', reviewData)
  showReviewModal.value = false
  
  // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–∑—ã–≤–∞
  alert('–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–∑—ã–≤! –û–Ω –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏.')
}

onMounted(() => {
  // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏–ª–∏ –¥—Ä—É–≥—É—é –ª–æ–≥–∏–∫—É
  console.log('Order success page loaded for order:', orderId.value)
})
</script>